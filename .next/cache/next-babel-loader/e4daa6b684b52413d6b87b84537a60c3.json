{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState } from 'react';\nimport { baseConfig } from '../../services/restservice';\nimport Theme from '../../styles/theme';\n\nfunction UploadImage(_ref) {\n  var firstLoadImages = _ref.firstLoadImages;\n\n  var _useState = useState(firstLoadImages),\n      images = _useState[0],\n      setImages = _useState[1];\n\n  var _useState2 = useState(null),\n      file = _useState2[0],\n      setFile = _useState2[1];\n\n  var _useState3 = useState(null),\n      preview = _useState3[0],\n      setPreview = _useState3[1];\n\n  var _useState4 = useState(null),\n      multipreview = _useState4[0],\n      setMultiPreview = _useState4[1];\n\n  var _useState5 = useState(false),\n      loadingImages = _useState5[0],\n      setLoadingImages = _useState5[1];\n\n  var uploadImageSingle = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var formData, uploadImage;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n\n              if (!(file == null)) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 3:\n              formData = new FormData();\n              formData.append(\"myFile\", file);\n              _context.next = 7;\n              return fetch(baseConfig.baseURL + '/uploadfile', {\n                method: 'POST',\n                body: formData\n              }).then(function (response) {\n                return response.json();\n              });\n\n            case 7:\n              uploadImage = _context.sent;\n\n              if (uploadImage) {\n                setPreview(null);\n                setFile(null);\n                loadImages(e);\n              }\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function uploadImageSingle(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var uploadImageMultiple = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      var formData, i, newupload;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              console.log(multipreview);\n\n              if (!(multipreview == null)) {\n                _context2.next = 4;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 4:\n              formData = new FormData();\n\n              for (i = 0; i < file.length; i++) {\n                console.log(file[i]);\n                formData.append(\"myFiles\", file[i]);\n              }\n\n              console.log(formData);\n              _context2.next = 9;\n              return fetch(baseConfig.baseURL + '/uploadmultiple', {\n                method: 'POST',\n                body: formData\n              }).then(function (response) {\n                return response.json();\n              });\n\n            case 9:\n              newupload = _context2.sent;\n              console.log(newupload);\n\n              if (newupload) {\n                setMultiPreview(null);\n                setFile(null);\n                console.log(newupload);\n                loadImages(e);\n              }\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function uploadImageMultiple(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleFileChangeSingle = function handleFileChangeSingle(e) {\n    e.persist();\n    setPreview(URL.createObjectURL(e.target.files[0]));\n    setFile(e.target.files[0]);\n    console.log(e.target.files[0]);\n  };\n\n  var handleFileChangeMulti = function handleFileChangeMulti(e) {\n    e.persist();\n    setFile(e.target.files);\n    var files = e.target.files;\n    var mpreview = [];\n\n    for (var i = 0; i < files.length; i++) {\n      mpreview.push(URL.createObjectURL(files[i]));\n    }\n\n    setMultiPreview(mpreview);\n  };\n\n  var removeImage = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e, image) {\n      var newremove;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              e.persist();\n              setLoadingImages(true);\n              setImages(null);\n              _context3.next = 5;\n              return fetch(baseConfig.baseURL + '/removeimage/' + image, {\n                method: 'DELETE'\n              }).then(function (response) {\n                return response.status;\n              });\n\n            case 5:\n              newremove = _context3.sent;\n\n              if (newremove) {\n                console.log(newremove);\n                loadImages(e);\n              }\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function removeImage(_x3, _x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var loadImages = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e) {\n      var getImages;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              e.preventDefault();\n              setLoadingImages(true);\n              _context4.next = 4;\n              return fetch('http://localhost:3600/getallimages', {\n                method: 'GET'\n              }).then(function (response) {\n                return response.json();\n              });\n\n            case 4:\n              getImages = _context4.sent;\n\n              if (getImages) {\n                setImages(getImages.images);\n              }\n\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function loadImages(_x5) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var doneLoading = function doneLoading(e) {\n    e.persist();\n    setLoadingImages(false);\n  };\n\n  return __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'body'\n  }, __jsx(\"div\", {\n    id: \"left\",\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, __jsx(\"h2\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, \"Single Image Upload\"), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'uploadform'\n  }, __jsx(\"form\", {\n    onSubmit: uploadImageSingle,\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'previewframe'\n  }, __jsx(\"img\", {\n    src: preview ? preview : '/imageplaceholder.png',\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'preview'\n  })), __jsx(\"label\", {\n    htmlFor: \"fileid\",\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, file ? file.name : 'Select image'), __jsx(\"input\", {\n    id: \"fileid\",\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: handleFileChangeSingle,\n    required: true,\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }), __jsx(\"button\", {\n    type: \"submit\",\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, \"Upload Image\"))), __jsx(\"h2\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, \"Multiple Image Upload\"), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'uploadform'\n  }, __jsx(\"form\", {\n    onSubmit: uploadImageMultiple,\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'previewframe'\n  }, multipreview == null ? __jsx(\"img\", {\n    src: \"/imageplaceholder.png\",\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'preview'\n  }) : multipreview.map(function (image, i) {\n    return __jsx(\"div\", {\n      className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'imgframepreview'\n    }, __jsx(\"img\", {\n      src: image,\n      className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n    }));\n  })), __jsx(\"label\", {\n    htmlFor: \"fileidmulti\",\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, \"Select images\"), __jsx(\"input\", {\n    id: \"fileidmulti\",\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: handleFileChangeMulti,\n    required: true,\n    multiple: true,\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }), __jsx(\"button\", {\n    type: \"submit\",\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, \"Upload Images\")))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'images'\n  }, __jsx(\"h1\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, \"My Images\"), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'imageholder'\n  }, images != null ? images.map(function (image, i) {\n    if (i == images.length - 1) {\n      return __jsx(\"div\", {\n        key: i,\n        className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'imgframe'\n      }, __jsx(\"div\", {\n        onClick: function onClick(e) {\n          return removeImage(e, image);\n        },\n        className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'x'\n      }, \"x\"), __jsx(\"img\", {\n        onLoad: doneLoading,\n        src: baseConfig.backendImages + image,\n        className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n      }), __jsx(\"h3\", {\n        className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n      }, image.split('').map(function (_char, i) {\n        if (i > 13) return _char;\n      })));\n    } else {\n      return __jsx(\"div\", {\n        key: i,\n        className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'imgframe'\n      }, __jsx(\"div\", {\n        onClick: function onClick(e) {\n          return removeImage(e, image);\n        },\n        className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'x'\n      }, \"x\"), __jsx(\"img\", {\n        src: baseConfig.backendImages + image,\n        className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n      }), __jsx(\"h3\", {\n        className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n      }, image.split('').map(function (_char2, i) {\n        if (i > 13) return _char2;\n      })));\n    }\n  }) : __jsx(\"h2\", {\n    onClick: loadImages,\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]])\n  }, \"Load Images\"), __jsx(\"img\", {\n    src: \"/loading_a.gif\",\n    className: _JSXStyle.dynamic([[\"2127230592\", [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]]]) + \" \" + 'loader'\n  }))), __jsx(_JSXStyle, {\n    id: \"2127230592\",\n    dynamic: [loadingImages ? 'block' : 'none', Theme.colors.gunmetal, Theme.colors.gunmetal, Theme.colors.charcoal]\n  }, [\".imageholder.__jsx-style-dynamic-selector{float:left;width:90%;padding:20px 5%;padding-top:250px;height:300px;overflow-y:scroll;position:relative;margin-top:20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;}\", \".loader.__jsx-style-dynamic-selector{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);display:\".concat(loadingImages ? 'block' : 'none', \";width:52px;height:52px;}\"), \".imgframe.__jsx-style-dynamic-selector{float:left;width:150px;height:120px;margin:8px;overflow:hidden;position:relative;background:rgba(200,200,200,.2);box-shadow:0 0 1px \".concat(Theme.colors.gunmetal, \";}\"), \".imgframe.__jsx-style-dynamic-selector h3.__jsx-style-dynamic-selector{position:absolute;bottom:0;text-align:center;left:0;width:100%;padding:10px 0;margin:0;background:rgba(255,255,255,.7);color:\".concat(Theme.colors.gunmetal, \";font:12px 'Open Sans';}\"), \".imgframe.__jsx-style-dynamic-selector img.__jsx-style-dynamic-selector{position:absolute;width:100%;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}\", \".x.__jsx-style-dynamic-selector{position:absolute;right:10px;top:10px;padding:0 8px;padding-bottom:4px;text-align:center;font:18px 'Roboto';cursor:pointer;opacity:.7;-webkit-transition:all .3s ease;transition:all .3s ease;z-index:999;background:rgba(255,255,255,1);}\", \".x.__jsx-style-dynamic-selector:hover{opacity:1;}\", \".images.__jsx-style-dynamic-selector{float:left;width:60%;}\", \".images.__jsx-style-dynamic-selector h1.__jsx-style-dynamic-selector{float:left;font:30px 'Montserrat';margin:0;margin-left:30px;padding:10px;}\", \".uploadform.__jsx-style-dynamic-selector input.__jsx-style-dynamic-selector{display:none;}\", \".uploadform.__jsx-style-dynamic-selector label.__jsx-style-dynamic-selector{position:absolute;top:60px;left:20px;padding:10px;cursor:pointer;opacity:.7;-webkit-transition:all .3s ease;transition:all .3s ease;font:14px 'Roboto';}\", \".uploadform.__jsx-style-dynamic-selector label.__jsx-style-dynamic-selector:hover{opacity:1;}\", \".uploadform.__jsx-style-dynamic-selector button.__jsx-style-dynamic-selector{position:absolute;bottom:90px;left:20px;padding:10px;cursor:pointer;opacity:.7;-webkit-transition:all .3s ease;transition:all .3s ease;font:14px 'Roboto';}\", \".uploadform.__jsx-style-dynamic-selector .previewframe.__jsx-style-dynamic-selector{position:absolute;right:20px;top:20px;width:300px;max-height:300px;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;}\", \".uploadform.__jsx-style-dynamic-selector .previewframe.__jsx-style-dynamic-selector .preview.__jsx-style-dynamic-selector{float:left;width:100%;height:auto;}\", \".previewframe.__jsx-style-dynamic-selector .imgframepreview.__jsx-style-dynamic-selector{float:left;width:80px;height:80px;margin:5px;position:relative;}\", \".imgframepreview.__jsx-style-dynamic-selector img.__jsx-style-dynamic-selector{width:100%;height:100%;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}\", \".uploadform.__jsx-style-dynamic-selector form.__jsx-style-dynamic-selector{float:left;width:100%;height:100%;}\", \".uploadform.__jsx-style-dynamic-selector{float:left;width:100%;position:relative;min-height:300px;}\", \"#left.__jsx-style-dynamic-selector h2.__jsx-style-dynamic-selector{float:left;margin:0;width:90%;padding:10px 5%;box-shadow:0 0 1px \".concat(Theme.colors.charcoal, \";font:22px 'Raleway';}\"), \"#left.__jsx-style-dynamic-selector{float:left;width:40%;height:100%;}\", \".body.__jsx-style-dynamic-selector{float:left;width:100%;height:100%;margin-top:90px;}\"]));\n}\n\nUploadImage.getInitialProps = /*#__PURE__*/function () {\n  var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e) {\n    var getimg;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.next = 2;\n            return fetch(baseConfig.baseURL + '/getallimages', {\n              method: 'GET'\n            }).then(function (response) {\n              return response.json();\n            });\n\n          case 2:\n            getimg = _context5.sent;\n            return _context5.abrupt(\"return\", {\n              firstLoadImages: getimg.images\n            });\n\n          case 4:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n\n  return function (_x6) {\n    return _ref6.apply(this, arguments);\n  };\n}();\n\nexport default UploadImage;","map":null,"metadata":{},"sourceType":"module"}